[root@v742573 primetrack]# pm2 logs primetrack --lines 20
[TAILING] Tailing last 20 lines for [primetrack] process (change the value with --lines option)
/root/.pm2/logs/primetrack-out.log last 20 lines:
0|primetra | 
0|primetra | > rest-express@1.0.0 start
0|primetra | > NODE_ENV=production node dist/index.cjs
0|primetra | 
0|primetra | 
0|primetra | > rest-express@1.0.0 start
0|primetra | > NODE_ENV=production node dist/index.cjs
0|primetra | 
0|primetra | 
0|primetra | > rest-express@1.0.0 start
0|primetra | > NODE_ENV=production node dist/index.cjs
0|primetra | 
0|primetra | 
0|primetra | > rest-express@1.0.0 start
0|primetra | > NODE_ENV=production node dist/index.cjs
0|primetra | 
0|primetra | 
0|primetra | > rest-express@1.0.0 start
0|primetra | > NODE_ENV=production node dist/index.cjs
0|primetra | 

/root/.pm2/logs/primetrack-error.log last 20 lines:
0|primetra | proved"){let o=(await this.getOfferLandings(e)).map(l=>l.id);return await this.createPublisherOffer({offerId:e,publisherId:t,approvedLandings:o.length>0?o:null}),!0}return!1}async getPublisherAccessMap(e,t){if(e.length===0)return new Set;let s=await k.select({offerId:tt.offerId}).from(tt).where(Q(Te(tt.offerId,e),w(tt.publisherId,t),w(tt.status,"revoked"))),n=new Set(s.map(o=>o.offerId)),a=await k.select({offerId:Ne.offerId}).from(Ne).where(Q(Te(Ne.offerId,e),w(Ne.publisherId,t))),i=new Set;for(let o of a)n.has(o.offerId)||i.add(o.offerId);return i}async getAdvertisersForPublisher(e){let t=await k.select().from(Xe).where(w(Xe.publisherId,e)),s=[];for(let n of t){let a=await this.getUser(n.advertiserId);a&&s.push({...n,advertiser:a})}return s}async getPublishersByAdvertiser(e){let t=await k.select().from(Xe).where(Q(w(Xe.advertiserId,e),w(Xe.status,"active"))),s=[];for(let n of t){let a=await this.getUser(n.publisherId);a&&s.push({...n,publisher:a})}return s}async addPublisherToAdvertiser(e,t,s="pending"){let n=await k.select().from(Xe).where(Q(w(Xe.publisherId,e),w(Xe.advertiserId,t)));if(n.length>0)return n[0];let[a]=await k.insert(Xe).values({publisherId:e,advertiserId:t,status:s}).returning();return a}async updatePublisherReferralSettings(e,t,s){let[n]=await k.update(Xe).set(s).where(Q(w(Xe.publisherId,e),w(Xe.advertiserId,t))).returning();return n}async getPublisherReferralSettings(e,t){let[s]=await k.select({referralEnabled:Xe.referralEnabled,referralRate:Xe.referralRate}).from(Xe).where(Q(w(Xe.publisherId,e),w(Xe.advertiserId,t)));if(s)return{referralEnabled:s.referralEnabled,referralRate:s.referralRate||"0"}}async getReferredPublishers(e,t){return await k.select().from(B).where(Q(w(B.referredByPublisherId,e),w(B.referredByAdvertiserId,t)))}async createReferralEarning(e){let[t]=await k.insert(on).values(e).returning();return t}async getReferralEarnings(e,t){return k.select().from(on).where(Q(w(on.referrerId,e),w(on.advertiserId,t))).orderBy(ie(on.createdAt))}async getReferralEarningByConversion(e){let[t]=await k.select().from(on).where(w(on.conversionId,e));return t}async getReferralStats(e,t){let s=await k.select({count:v`count(*)::int`}).from(B).where(Q(w(B.referredByPublisherId,e),w(B.referredByAdvertiserId,t))),a=(await k.execute(v`
0|primetra |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
0|primetra | 
0|primetra | Error: DATABASE_URL environment variable is not set
0|primetra |     at /var/www/primetrack/dist/index.cjs:70:31567
0|primetra |     at /var/www/primetrack/dist/index.cjs:1:225
0|primetra |     at /var/www/primetrack/dist/index.cjs:70:36220
0|primetra |     at /var/www/primetrack/dist/index.cjs:1:225
0|primetra |     at Object.<anonymous> (/var/www/primetrack/dist/index.cjs:256:4417)
0|primetra |     at Module._compile (node:internal/modules/cjs/loader:1521:14)
0|primetra |     at Module._extensions..js (node:internal/modules/cjs/loader:1623:10)
0|primetra |     at Module.load (node:internal/modules/cjs/loader:1266:32)
0|primetra |     at Module._load (node:internal/modules/cjs/loader:1091:12)
0|primetra |     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:164:12)
0|primetra | 
0|primetra | Node.js v20.20.0

