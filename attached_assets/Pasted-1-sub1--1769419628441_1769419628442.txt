1Ô∏è‚É£ sub1 –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —ç—Ç–æ?
–ö–æ—Ä–æ—Ç–∫–æ: –î–ê, –∫–∞–∫ –¥–µ—Ñ–æ–ª—Ç ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ù–æ –Ω–µ –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.
–ü–æ—á–µ–º—É sub1 ‚Äî –¥–µ-—Ñ–∞–∫—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç

Keitaro, Binom, Voluum, RedTrack ‚Äî –≤—Å–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

–ø—Ä–∏–Ω–∏–º–∞—é—Ç {subid} —É —Å–µ–±—è

–ø–µ—Ä–µ–¥–∞—é—Ç –µ–≥–æ –¥–∞–ª—å—à–µ –≤ sub1

90% –±–∞–π–µ—Ä–æ–≤:

–Ω–µ –º–µ–Ω—è—é—Ç –¥–µ—Ñ–æ–ª—Ç—ã

–∏—Å–ø–æ–ª—å–∑—É—é—Ç sub1 –ø–æ–¥ click_id

üëâ –ü–æ—ç—Ç–æ–º—É:

sub1 = –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–µ—Ñ–æ–ª—Ç

–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è PrimeTrack –¥–æ–ª–∂–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç—å:

¬´–ü–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ click_id –≤ sub1¬ª

‚ùó –ù–æ –ø–∞—Ä—Ç–Ω—ë—Ä –ú–û–ñ–ï–¢ –ø–µ—Ä–µ–¥–∞—Ç—å –∏–Ω–∞—á–µ

–î–∞, –∏ —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å:

–∫—Ç–æ-—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç sub2

–∫—Ç–æ-—Ç–æ cid

–∫—Ç–æ-—Ç–æ clickid

–∫—Ç–æ-—Ç–æ s1

‚ùå –°–µ–π—á–∞—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ

–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ –∂—ë—Å—Ç–∫–æ –æ–∂–∏–¥–∞–µ—Ç sub1.

‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–Ω–∞ –±—É–¥—É—â–µ–µ)

–í –º–æ–¥–µ–ª–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–∞:

buyerClickIdSource: "sub1" | "sub2" | "sub3" | "custom"


–ò –ø–æ—Ç–æ–º:

const buyerClickId =
  click[endpoint.buyerClickIdSource] || null;


üìå –ù–û ‚Äî —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø.
–ù–∞ —Å–µ–π—á–∞—Å sub1 –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç ‚Äî –∞–±—Å–æ–ª—é—Ç–Ω–æ –û–ö.

2Ô∏è‚É£ Fallback –Ω–∞ click.clickId ‚Äî –Ω—É–∂–µ–Ω –∏–ª–∏ –Ω–µ—Ç?
–ö–æ—Ä–æ—Ç–∫–æ: –î–ê, –Ω–æ –ù–ï –¥–ª—è Keitaro.

–†–∞–∑–¥–µ–ª–∏–º –ø–æ –∫–µ–π—Å–∞–º.

üîπ –ö–µ–π—Å 1: Keitaro / –≤–Ω–µ—à–Ω–∏–π —Ç—Ä–µ–∫–µ—Ä (–æ—Å–Ω–æ–≤–Ω–æ–π –∫–µ–π—Å)

–ï—Å–ª–∏ sub1 –ø—É—Å—Ç–æ–π:

Keitaro –ù–ò–ß–ï–ì–û –Ω–µ —Å–º–∞—Ç—á–∏—Ç

fallback –Ω–∞ internal ID:

‚ùå –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

‚ùå —Å–æ–∑–¥–∞—ë—Ç –ª–æ–∂–Ω–æ–µ –æ—â—É—â–µ–Ω–∏–µ, —á—Ç–æ ¬´–ø–± —É—à—ë–ª¬ª

‚û°Ô∏è –° —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –º–∞—Ç—á–∏–Ω–≥–∞ fallback –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω.

üîπ –ö–µ–π—Å 2: —Å—Ç–∞—Ä—ã–µ –ø–∞—Ä—Ç–Ω—ë—Ä—ã / –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

–ø–∞—Ä—Ç–Ω—ë—Ä:

–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Keitaro

–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ª—é–±–æ–π ID

–∏–ª–∏ —É–∂–µ –ø—Ä–∏–≤—ã–∫ –∫ internal click_id

‚û°Ô∏è –¢–£–¢ fallback –°–ü–ê–°–ê–ï–¢ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)
const buyerClickId = click.sub1;

if (buyerClickId) {
  url.searchParams.set(clickIdParam, buyerClickId);
} else {
  url.searchParams.set(clickIdParam, click.clickId); // fallback
}


–ò –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å:

if (!click.sub1) {
  logger.warn(
    `Publisher postback sent with internal clickId. click=${click.id}`
  );
}

‚ùå –ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É—é
url.searchParams.set(clickIdParam, "");


–ü–æ—á–µ–º—É:

–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–∫–µ—Ä—ã –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç –ø—É—Å—Ç—ã–µ postback

—Å–ª–æ–∂–Ω–µ–µ –¥–µ–±–∞–∂–∏—Ç—å

—Ö—É–∂–µ backward compatibility

3Ô∏è‚É£ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å ‚Äî —Å–ª–æ–º–∞–µ—Ç –ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∏—Ö –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤?
–ö–æ—Ä–æ—Ç–∫–æ: –ù–ï–¢, –µ—Å–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å fallback

–†–∞–∑–±–µ—Ä—ë–º –ø–æ —Ç–∏–ø–∞–º –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤:

üü¢ –ü–∞—Ä—Ç–Ω—ë—Ä—ã —Å Keitaro (–ù–û–†–ú–ê–õ–¨–ù–´–ô –∫–µ–π—Å)

—Ä–∞–Ω—å—à–µ:

–ø–æ–ª—É—á–∞–ª–∏ internal click_id ‚Üí ‚ùå –ª–∏–¥—ã –Ω–µ –º–∞—Ç—á–∏–ª–∏—Å—å

—Ç–µ–ø–µ—Ä—å:

–ø–æ–ª—É—á–∞—é—Ç —Å–≤–æ–π click_id ‚Üí ‚úÖ –í–°–Å –ü–û–Ø–í–ò–¢–°–Ø

üìà –≠—Ç–æ —Ñ–∏–∫—Å, –∞ –Ω–µ breaking change

üü¢ –ü–∞—Ä—Ç–Ω—ë—Ä—ã –±–µ–∑ —Ç—Ä–µ–∫–µ—Ä–∞

–∏–º –≤—Å—ë —Ä–∞–≤–Ω–æ, –∫–∞–∫–æ–π ID

fallback —Å–æ—Ö—Ä–∞–Ω–∏—Ç —Å—Ç–∞—Ä–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

üü° –ü–∞—Ä—Ç–Ω—ë—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ:

–Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç sub1

–Ω–æ –∂–¥—É—Ç –∏–º–µ–Ω–Ω–æ –µ–≥–æ

üëâ –û–Ω–∏ –∏ —Ä–∞–Ω—å—à–µ –±—ã–ª–∏ —Å–ª–æ–º–∞–Ω—ã, –ø—Ä–æ—Å—Ç–æ —ç—Ç–æ–≥–æ –Ω–µ –∑–∞–º–µ—á–∞–ª–∏.

‚úÖ –§–ò–ù–ê–õ–¨–ù–´–ô –í–ï–†–î–ò–ö–¢
–¢–≤–æ–π —Ç–µ–∫—É—â–∏–π —Ñ–∏–∫—Å:
url.searchParams.set(clickIdParam, click.sub1 || click.clickId);

–û—Ü–µ–Ω–∫–∞:

‚úÖ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

‚úÖ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ

‚úÖ —Ä–µ—à–∞–µ—Ç Keitaro

‚ö†Ô∏è –Ω–µ–∏–¥–µ–∞–ª—å–Ω–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä—É–µ–º–æ

–ò–¥–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ–¥-–≤–∞—Ä–∏–∞–Ω—Ç:
if (click.sub1) {
  url.searchParams.set(clickIdParam, click.sub1);
} else {
  url.searchParams.set(clickIdParam, click.clickId);
  logger.warn("Publisher click_id fallback to internal ID", { clickId: click.id });
}
