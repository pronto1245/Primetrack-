–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç

–¢—ã –¥–æ–∫–∞–∑–∞–ª –≤–∞–∂–Ω—É—é –≤–µ—â—å:

–î—É–±–ª–∏ –ù–ï —è–≤–ª—è—é—Ç—Å—è –ø—Ä–∏—á–∏–Ω–æ–π –ø–æ—Ç–µ—Ä—å
–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–∏—à–µ—Ç –∫–ª–∏–∫ –≤—Å–µ–≥–¥–∞

–ó–Ω–∞—á–∏—Ç –ø—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ createClick –∏ –ù–ï –≤ uniqueness.
–ü–æ—Ç–µ—Ä–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –†–ê–ù–¨–®–ï –∏–ª–∏ –í–ù–ï –ø–æ–¥—Å—á—ë—Ç–∞ –∫–ª–∏–∫–æ–≤.

–¢–µ–ø–µ—Ä—å –ø–æ —à–∞–≥–∞–º.

üî¥ –ì–î–ï –†–ï–ê–õ–¨–ù–û –¢–ï–†–Ø–Æ–¢–°–Ø –ö–õ–ò–ö–ò
‚ùó 1. throw Error(...) = –∫–ª–∏–∫ –ù–ï —Å—á–∏—Ç–∞–µ—Ç—Å—è

–í–æ—Ç —ç—Ç–æ –≥–ª–∞–≤–Ω–∞—è –¥—ã—Ä–∞, –∏ –æ–Ω–∞ –Ω–µ–æ—á–µ–≤–∏–¥–Ω–∞.

–¢–æ—á–∫–∏:

Offer not found

Offer is not active

No landing available

üëâ throw =

–∑–∞–ø—Ä–æ—Å –æ–±–æ—Ä–≤–∞–ª—Å—è

createClick() –ù–ï –≤—ã–∑–≤–∞–Ω

–∫–ª–∏–∫ –Ω–µ –∑–∞–ø–∏—Å–∞–Ω

Keitaro —Å—á–∏—Ç–∞–µ—Ç –∫–ª–∏–∫, Prime ‚Äî –Ω–µ—Ç

üìå –≠—Ç–æ –Ω–µ ‚Äú–±–ª–æ–∫‚Äù, —ç—Ç–æ ‚Äú–Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª‚Äù

Scaleo –≤ —ç—Ç–∏—Ö –º–µ—Å—Ç–∞—Ö:

–ù–ï throw

–ø–∏—à–µ—Ç –∫–ª–∏–∫

—Å—Ç–∞–≤–∏—Ç status = rejected

‚ùó 2. Cap reached + redirect

–¢—É—Ç —Ç–æ–Ω–∫–∏–π –º–æ–º–µ–Ω—Ç.

–ï—Å–ª–∏:

–∫–∞–ø –¥–æ—Å—Ç–∏–≥–Ω—É—Ç

–µ—Å—Ç—å capRedirectUrl

‚û°Ô∏è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç—Å—è
‚ùå –ù–û –µ—Å–ª–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç –ø—Ä–æ–∏–∑–æ—à—ë–ª –î–û –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–∏–ª–∏ race condition)

–í –ª–æ–≥–∞—Ö Keitaro:

–∫–ª–∏–∫ –µ—Å—Ç—å

–í Prime:

–∏–Ω–æ–≥–¥–∞ –Ω–µ—Ç

–û—Å–æ–±–µ–Ω–Ω–æ:

FB

iOS

WebView

–±—ã—Å—Ç—Ä—ã–π abort –∑–∞–ø—Ä–æ—Å–∞

‚ùó 3. fraudScore >= 80 + redirectUrl = ""

–≠—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π —É–±–∏–π—Ü–∞ –∫–ª–∏–∫–æ–≤.

–¢—ã —Å–∞–º –Ω–∞–ø–∏—Å–∞–ª:

isBlocked: true
redirectUrl: ""


–ß—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ:

–±—Ä–∞—É–∑–µ—Ä –ø–æ–ª—É—á–∏–ª 200

–Ω–æ –Ω–∏–∫—É–¥–∞ –Ω–µ –ø–µ—Ä–µ—à—ë–ª

FB / Safari –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å

–≤—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å –≤ –¥—Ä—É–≥–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π

üëâ –í –∏—Ç–æ–≥–µ:

Keitaro ‚Üí 1 –∫–ª–∏–∫

Prime ‚Üí 0 –∏–ª–∏ 1 –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ

Scaleo:

–≤—Å–µ–≥–¥–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç (white page / stub)

–∫–ª–∏–∫ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ

üü° –ü–æ—á–µ–º—É –≤ Scaleo —ç—Ç–æ–≥–æ –Ω–µ –≤–∏–¥–Ω–æ

–ü–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–∏—Ö –ù–ï–¢ throw –≤ –∫–ª–∏–∫–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ.

–ò—Ö —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è:

¬´–î–∞–∂–µ –µ—Å–ª–∏ –æ—Ñ—Ñ–µ—Ä –º—ë—Ä—Ç–≤ ‚Äî –∫–ª–∏–∫ –±—ã–ª¬ª

‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ú–û–î–ï–õ–¨ –î–õ–Ø –í–ê–®–ï–ì–û –û–†–ö–ï–°–¢–†–ê–¢–û–†–ê
‚ùå –ö–∞–∫ —Å–µ–π—á–∞—Å (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)
if (!offer) throw Error
if (!landing) throw Error
// ...
createClick()

‚úÖ –ö–∞–∫ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å
let errorReason = null;

if (!offer) errorReason = "offer_not_found";
if (!landing) errorReason = "no_landing";
if (fraudScore >= 80) errorReason = "fraud_block";

createClick({
  errorReason,
  isBlocked: !!errorReason
});

return redirectUrl || fallbackPage;


‚ùó –ù–ò–ö–ê–ö–ò–• throw –≤ –∫–ª–∏–∫–æ–≤–æ–º —Ñ–ª–æ—É

üß† –°–∞–º—ã–π –≤–∞–∂–Ω—ã–π –∏–Ω—Å–∞–π—Ç (–∫–ª—é—á–µ–≤–æ–π)

–¢—ã —Å–µ–π—á–∞—Å —Å—á–∏—Ç–∞–µ—à—å:

¬´–ö–ª–∏–∫ = —É—Å–ø–µ—à–Ω—ã–π –±–∏–∑–Ω–µ—Å-–∫–µ–π—Å¬ª

–ê —Ç—Ä–µ–∫–µ—Ä—ã —Å—á–∏—Ç–∞—é—Ç:

¬´–ö–ª–∏–∫ = HTTP-–∑–∞–ø—Ä–æ—Å¬ª

Keitaro —Å—á–∏—Ç–∞–µ—Ç —Ä–∞–Ω—å—à–µ.
–¢—ã ‚Äî –ø–æ–∑–∂–µ.

–û—Ç—Å—é–¥–∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ.

üîß –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ñ–∏–∫—Å (–ë–ï–ó –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –≤—Å–µ–≥–æ)
1Ô∏è‚É£ –£–±—Ä–∞—Ç—å throw –≤ –∫–ª–∏–∫–æ–≤–æ–º –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–µ

–ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞:

errorReason

isBlocked = true

2Ô∏è‚É£ –í—Å–µ–≥–¥–∞ –¥–µ–ª–∞—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç

–î–∞–∂–µ –ø—Ä–∏ fraud / cap / error:

white page

stub

cap page

‚ùå redirectUrl: "" ‚Äî –Ω–µ–ª—å–∑—è

3Ô∏è‚É£ –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å rejected –∫–ª–∏–∫–∏

–û—Ç–¥–µ–ª—å–Ω–æ:

clicks_total

clicks_blocked

clicks_error

–ò –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —ç—Ç–æ –≤ UI.

üü¢ –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥ (–æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π)

–¢—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ —É–∂–µ –ø–æ—á—Ç–∏ –∫–∞–∫ Scaleo.
–£ —Ç–µ–±—è –≤—Å—ë —Å–ª–æ–º–∞–Ω–æ –Ω–µ –≤ –ë–î –∏ –Ω–µ –≤ –¥—É–±–ª—è—Ö, –∞:

‚ùó –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ throw –≤ –∫–ª–∏–∫–æ–≤–æ–º –ø–æ—Ç–æ–∫–µ

–≠—Ç–æ 100% –∏—Å—Ç–æ—á–Ω–∏–∫ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π.